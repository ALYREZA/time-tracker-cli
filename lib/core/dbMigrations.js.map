{"version":3,"sources":["../../src/core/dbMigrations.js"],"names":["migrateToV2","tasks","promises","migrate","key","task","Promise","resolve","reject","timing","update","start","stop","timings","Object","keys","forEach","push","k","all"],"mappings":";;;;;AAAO,IAAMA,oCAAc,SAAdA,WAAc,CAAUC,KAAV,EAAgB;AACvC,QAAIC,WAAW,EAAf;AACA,QAAIC,UAAU,SAAVA,OAAU,CAACC,GAAD,EAAMC,IAAN;AAAA,eAAe,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;AAE1D,gBAAIC,SAAS,EAAb;AACA,gBAAIC,SAAS,KAAb;;AAEA,gBAAIL,KAAKM,KAAT,EAAgB;AACZD,yBAAS,IAAT;AACAD,uBAAOE,KAAP,GAAeN,KAAKM,KAApB;AACA,uBAAON,KAAKM,KAAZ;AACH;;AAED,gBAAIN,KAAKO,IAAT,EAAe;AACXH,uBAAOG,IAAP,GAAcP,KAAKO,IAAnB;AACA,uBAAOP,KAAKO,IAAZ;AACH;;AAED,gBAAIF,MAAJ,EAAY;AACRL,qBAAKQ,OAAL,GAAe,CAACJ,MAAD,CAAf;AACH;;AAEDF,oBAAQ;AACJH,wBADI;AAEJC;AAFI,aAAR;AAIH,SAxB4B,CAAf;AAAA,KAAd;;AA0BAS,WAAOC,IAAP,CAAYd,KAAZ,EAAmBe,OAAnB,CAA2B;AAAA,eAAKd,SAASe,IAAT,CAAed,QAAQe,CAAR,EAAWjB,MAAMiB,CAAN,CAAX,CAAf,CAAL;AAAA,KAA3B;;AAEA,WAAOZ,QAAQa,GAAR,CAAYjB,QAAZ,CAAP;AACH,CA/BM","file":"dbMigrations.js","sourcesContent":["export const migrateToV2 = function (tasks){\n    let promises = []\n    let migrate = (key, task) => new Promise((resolve, reject) => {\n\n        let timing = {}\n        let update = false\n\n        if (task.start) {\n            update = true\n            timing.start = task.start\n            delete task.start\n        }\n\n        if (task.stop) {\n            timing.stop = task.stop\n            delete task.stop\n        }\n\n        if (update) {\n            task.timings = [timing]\n        }\n\n        resolve({\n            key,\n            task\n        })\n    })\n\n    Object.keys(tasks).forEach(k => promises.push( migrate(k, tasks[k]) ))\n\n    return Promise.all(promises)\n}\n"]}